---
- name: create /etc/systemd/system/firewalld.service.d
  file: state=directory dest=/etc/systemd/system/firewalld.service.d

- name: put /etc/systemd/system/firewalld.service.d/docker.conf
  template: src=docker.conf dest=/etc/systemd/system/firewalld.service.d/docker.conf

- name: install firewalld
  apt: name=firewalld

- name: apply firewalld rules
  shell: firewall-cmd --add-port={{ item }}
  with_items: "{{ firewalld.open_ports }}"

- name: apply firewalld rules permanently
  shell: firewall-cmd --add-port={{ item }} --permanent
  with_items: "{{ firewalld.open_ports }}"
